
# REGULAR_ad v2

version 2 attempts to address a lot of the issues with v1.

# issues with v1

- no actual "macros", all meta-instructions were compiled
    - this is inefficient because meta-compile has to be run multiple times
- only ahead-of-time labels
    - labels were resolved immediately, which could cause issues if more padding is added
    - labels could not be referenced before they were defined (significant limitation)
- messy code
    - lots of repeat code for buffers and reallocation

# proposed solutions
- macros
    - keep meta-compile for basic features such as `jmp`
        - refactor to limit to two meta-compile passes
    - support defining sequences of instructions with arguments
        - these can be used as "macro instructions" with `@`
        - argument types can be checked
- labels
    - labels are treated as "value sources" and are only resolved at the end
    - labels can additionally specify positive offsets
- messy code
    - macro-defined buffers

# assembler-rearchitect

since "read instruction" can be more complex, it is probably better if it is read_instruction(arg1, arg2, arg3) rather than directly reading tokens. for example, when we throw macros into the mix, we have to fetch the "macro definition" and then push each of the instructions but replacing arguments.

# assembler flow/design

## read instruction

## read code



## lexer
lexer should continue as is, but add support for the new "data" definition types.
ultimately its job is just to convert characters to tokens of a defined type that we can operate on.
